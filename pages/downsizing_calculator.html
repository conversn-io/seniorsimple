<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Downsizing Calculator - RetireSafe.ly</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @media print {
            body { print-color-adjust: exact; }
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        .input-group {
            margin-bottom: 1rem;
        }
        .result-highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="max-w-7xl mx-auto p-6">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <i class="fas fa-home text-blue-600 mr-3"></i>
                Downsizing Calculator
            </h1>
            <p class="text-xl text-gray-600">Calculate the financial impact of downsizing your home in retirement</p>
            <div class="w-24 h-1 bg-blue-600 mx-auto mt-4 rounded"></div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Input Section -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Current Home Section -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-house-user text-green-600 mr-2"></i>
                        Current Home Details
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Current Home Value</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentHomeValue" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="450,000" value="450000">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Remaining Mortgage Balance</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="mortgageBalance" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="125,000" value="125000">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Selling Costs (%)</label>
                            <div class="relative">
                                <input type="number" id="sellingCosts" class="w-full pr-8 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="7" value="7" step="0.1">
                                <span class="absolute right-3 top-3 text-gray-500">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Property Taxes</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentTaxes" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="6,500" value="6500">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Insurance</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentInsurance" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2,400" value="2400">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Maintenance</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentMaintenance" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="4,500" value="4500">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Utilities</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentUtilities" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="3,200" value="3200">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">HOA Fees (Annual)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="currentHOA" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- New Home Section -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-home text-blue-600 mr-2"></i>
                        New Home Details
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">New Home Purchase Price</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newHomeValue" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="325,000" value="325000">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Moving Costs</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="movingCosts" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="8,500" value="8500">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Home Modifications</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="modifications" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="12,000" value="12000">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Closing Costs</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="closingCosts" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="6,500" value="6500">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Property Taxes</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newTaxes" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="4,200" value="4200">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Insurance</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newInsurance" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="1,800" value="1800">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Maintenance</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newMaintenance" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2,800" value="2800">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Utilities</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newUtilities" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2,400" value="2400">
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">HOA Fees (Annual)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-gray-500">$</span>
                                <input type="number" id="newHOA" class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2,400" value="2400">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="space-y-6">
                <!-- Key Results -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-calculator text-purple-600 mr-2"></i>
                        Financial Impact
                    </h2>
                    
                    <div class="result-highlight text-white rounded-lg p-4 mb-4">
                        <div class="text-center">
                            <div class="text-sm opacity-90">Net Equity Gain</div>
                            <div class="text-3xl font-bold" id="netEquityGain">$0</div>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                            <span class="text-sm font-medium text-gray-700">Annual Savings</span>
                            <span class="text-lg font-bold text-green-600" id="annualSavings">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                            <span class="text-sm font-medium text-gray-700">Monthly Savings</span>
                            <span class="text-lg font-bold text-blue-600" id="monthlySavings">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-orange-50 rounded-lg">
                            <span class="text-sm font-medium text-gray-700">Total Moving Costs</span>
                            <span class="text-lg font-bold text-orange-600" id="totalMovingCosts">$0</span>
                        </div>
                    </div>
                </div>

                <!-- Detailed Breakdown -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-chart-pie text-indigo-600 mr-2"></i>
                        Detailed Breakdown
                    </h3>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Home Sale Proceeds</span>
                            <span class="font-semibold" id="saleProceeds">$0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">New Home Total Cost</span>
                            <span class="font-semibold" id="newHomeTotalCost">$0</span>
                        </div>
                        <div class="border-t pt-2 mt-2">
                            <div class="flex justify-between font-bold">
                                <span>Net Cash Available</span>
                                <span id="netCashAvailable">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investment Potential -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-seedling text-green-600 mr-2"></i>
                        Investment Potential
                    </h3>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Expected Annual Return (%)</label>
                        <input type="number" id="investmentReturn" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="5" value="5" step="0.1">
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Annual Investment Income</span>
                            <span class="font-semibold text-green-600" id="annualInvestmentIncome">$0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total Annual Benefit</span>
                            <span class="font-bold text-green-600" id="totalAnnualBenefit">$0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
            <!-- Annual Costs Comparison -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-chart-bar text-blue-600 mr-2"></i>
                    Annual Costs Comparison
                </h3>
                <div class="chart-container">
                    <canvas id="costsChart"></canvas>
                </div>
            </div>

            <!-- 10-Year Financial Projection -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-chart-line text-green-600 mr-2"></i>
                    10-Year Cumulative Savings
                </h3>
                <div class="chart-container">
                    <canvas id="savingsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mt-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fas fa-lightbulb text-yellow-600 mr-2"></i>
                Key Insights
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600" id="paybackPeriod">0</div>
                    <div class="text-sm text-gray-600">Months to Break Even</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-2xl font-bold text-green-600" id="fiveYearSavings">$0</div>
                    <div class="text-sm text-gray-600">5-Year Total Savings</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600" id="tenYearSavings">$0</div>
                    <div class="text-sm text-gray-600">10-Year Total Savings</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg">
                    <div class="text-2xl font-bold text-orange-600" id="cashFlow">$0</div>
                    <div class="text-sm text-gray-600">Monthly Cash Flow</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-gray-500">
            <p class="mb-2">© 2024 RetireSafe.ly - Your Trusted Retirement Planning Partner</p>
            <p class="text-sm">This calculator provides estimates based on the information you provide. Consult with a financial advisor for personalized advice.</p>
        </div>
    </div>

    <script>
        let costsChart = null;
        let savingsChart = null;

        function calculateResults() {
            // Get input values
            const currentHomeValue = parseFloat(document.getElementById('currentHomeValue').value) || 0;
            const mortgageBalance = parseFloat(document.getElementById('mortgageBalance').value) || 0;
            const sellingCosts = parseFloat(document.getElementById('sellingCosts').value) || 0;
            const currentTaxes = parseFloat(document.getElementById('currentTaxes').value) || 0;
            const currentInsurance = parseFloat(document.getElementById('currentInsurance').value) || 0;
            const currentMaintenance = parseFloat(document.getElementById('currentMaintenance').value) || 0;
            const currentUtilities = parseFloat(document.getElementById('currentUtilities').value) || 0;
            const currentHOA = parseFloat(document.getElementById('currentHOA').value) || 0;

            const newHomeValue = parseFloat(document.getElementById('newHomeValue').value) || 0;
            const movingCosts = parseFloat(document.getElementById('movingCosts').value) || 0;
            const modifications = parseFloat(document.getElementById('modifications').value) || 0;
            const closingCosts = parseFloat(document.getElementById('closingCosts').value) || 0;
            const newTaxes = parseFloat(document.getElementById('newTaxes').value) || 0;
            const newInsurance = parseFloat(document.getElementById('newInsurance').value) || 0;
            const newMaintenance = parseFloat(document.getElementById('newMaintenance').value) || 0;
            const newUtilities = parseFloat(document.getElementById('newUtilities').value) || 0;
            const newHOA = parseFloat(document.getElementById('newHOA').value) || 0;

            const investmentReturn = parseFloat(document.getElementById('investmentReturn').value) || 0;

            // Calculate sale proceeds
            const sellingCostAmount = currentHomeValue * (sellingCosts / 100);
            const saleProceeds = currentHomeValue - mortgageBalance - sellingCostAmount;

            // Calculate new home total cost
            const newHomeTotalCost = newHomeValue + movingCosts + modifications + closingCosts;

            // Calculate net equity gain
            const netEquityGain = saleProceeds - newHomeTotalCost;

            // Calculate annual costs
            const currentAnnualCosts = currentTaxes + currentInsurance + currentMaintenance + currentUtilities + currentHOA;
            const newAnnualCosts = newTaxes + newInsurance + newMaintenance + newUtilities + newHOA;
            const annualSavings = currentAnnualCosts - newAnnualCosts;

            // Calculate investment income
            const annualInvestmentIncome = (netEquityGain > 0 ? netEquityGain : 0) * (investmentReturn / 100);
            const totalAnnualBenefit = annualSavings + annualInvestmentIncome;

            // Calculate payback period
            const totalMovingCosts = movingCosts + modifications + closingCosts + sellingCostAmount;
            const paybackPeriod = totalAnnualBenefit > 0 ? Math.round((totalMovingCosts / totalAnnualBenefit) * 12) : 0;

            // Update display
            document.getElementById('netEquityGain').textContent = formatCurrency(netEquityGain);
            document.getElementById('annualSavings').textContent = formatCurrency(annualSavings);
            document.getElementById('monthlySavings').textContent = formatCurrency(annualSavings / 12);
            document.getElementById('totalMovingCosts').textContent = formatCurrency(totalMovingCosts);
            document.getElementById('saleProceeds').textContent = formatCurrency(saleProceeds);
            document.getElementById('newHomeTotalCost').textContent = formatCurrency(newHomeTotalCost);
            document.getElementById('netCashAvailable').textContent = formatCurrency(netEquityGain);
            document.getElementById('annualInvestmentIncome').textContent = formatCurrency(annualInvestmentIncome);
            document.getElementById('totalAnnualBenefit').textContent = formatCurrency(totalAnnualBenefit);
            document.getElementById('paybackPeriod').textContent = paybackPeriod;
            document.getElementById('fiveYearSavings').textContent = formatCurrency(totalAnnualBenefit * 5);
            document.getElementById('tenYearSavings').textContent = formatCurrency(totalAnnualBenefit * 10);
            document.getElementById('cashFlow').textContent = formatCurrency(totalAnnualBenefit / 12);

            // Update charts
            updateCostsChart(currentAnnualCosts, newAnnualCosts, {
                currentTaxes, currentInsurance, currentMaintenance, currentUtilities, currentHOA,
                newTaxes, newInsurance, newMaintenance, newUtilities, newHOA
            });
            updateSavingsChart(totalAnnualBenefit);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function updateCostsChart(currentTotal, newTotal, breakdown) {
            const ctx = document.getElementById('costsChart').getContext('2d');
            
            if (costsChart) {
                costsChart.destroy();
            }

            costsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Property Taxes', 'Insurance', 'Maintenance', 'Utilities', 'HOA Fees'],
                    datasets: [{
                        label: 'Current Home',
                        data: [breakdown.currentTaxes, breakdown.currentInsurance, breakdown.currentMaintenance, breakdown.currentUtilities, breakdown.currentHOA],
                        backgroundColor: 'rgba(239, 68, 68, 0.8)',
                        borderColor: 'rgba(239, 68, 68, 1)',
                        borderWidth: 1
                    }, {
                        label: 'New Home',
                        data: [breakdown.newTaxes, breakdown.newInsurance, breakdown.newMaintenance, breakdown.newUtilities, breakdown.newHOA],
                        backgroundColor: 'rgba(34, 197, 94, 0.8)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Annual Cost Breakdown'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateSavingsChart(annualBenefit) {
            const ctx = document.getElementById('savingsChart').getContext('2d');
            
            if (savingsChart) {
                savingsChart.destroy();
            }

            const years = Array.from({length: 10}, (_, i) => i + 1);
            const cumulativeSavings = years.map(year => annualBenefit * year);

            savingsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years.map(year => `Year ${year}`),
                    datasets: [{
                        label: 'Cumulative Savings',
                        data: cumulativeSavings,
                        borderColor: 'rgba(34, 197, 94, 1)',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Cumulative Savings Over Time'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Add event listeners to all input fields
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', calculateResults);
        });

        // Initial calculation
        calculateResults();
    </script>
</body>
</html>
